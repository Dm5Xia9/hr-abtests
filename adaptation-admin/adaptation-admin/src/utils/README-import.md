# Импорт презентаций из различных форматов

## Импорт из SCORM

### Обзор

Данная функциональность позволяет импортировать SCORM-пакеты (ZIP-архивы, содержащие учебные материалы в формате SCORM 1.2 или SCORM 2004) и преобразовывать их в слайды презентации в нашей системе.

### Основные возможности

- Извлечение и анализ SCORM-пакетов (ZIP-архивы)
- Парсинг манифеста SCORM (imsmanifest.xml)
- Преобразование различных типов контента в соответствующие типы слайдов:
  - HTML-страницы → текстовые слайды
  - Изображения → слайды с изображениями
  - Тесты → тестовые слайды

### Алгоритм работы

1. Пользователь загружает SCORM-пакет через интерфейс
2. Система извлекает содержимое ZIP-архива и ищет файл манифеста (imsmanifest.xml)
3. Парсер анализирует манифест и создает структуру организации контента
4. Для каждого элемента в структуре:
   - Определяется тип контента
   - Содержимое преобразуется в соответствующий тип слайда
   - Добавляются метаданные (заголовки, описания)
5. Созданные слайды добавляются в презентацию

### Зависимости

- jszip: для распаковки ZIP-архивов
- xmldom: для парсинга XML-манифеста

### Поддерживаемые форматы SCORM

- SCORM 1.2
- SCORM 2004 (все издания)

## Импорт из PowerPoint (PPTX)

### Обзор

Данная функциональность позволяет импортировать презентации PowerPoint (PPTX) и преобразовывать их слайды в изображения, которые затем добавляются в презентацию нашей системы как слайды с изображениями.

### Основные возможности

- Извлечение содержимого PPTX-файлов (ZIP-архивы)
- Извлечение изображений из слайдов
- Автоматическое создание слайдов с изображениями

### Алгоритм работы

1. Пользователь загружает PPTX-файл через интерфейс
2. Система извлекает содержимое PPTX-файла (который по сути является ZIP-архивом)
3. Система ищет и извлекает изображения из:
   - Содержимого слайдов (медиа ресурсы)
   - Мастеров слайдов
   - Встроенных изображений
4. Система преобразует эти изображения в слайды типа "image"
5. Созданные слайды добавляются в презентацию

### Особенности и ограничения

- Обрабатывает основные изображения, содержащиеся в PPTX
- Не поддерживает анимацию и переходы
- Не сохраняет текстовый контент слайдов (только графическое представление)
- Генерирует временные URL-адреса для изображений (blob:)

### Зависимости

- jszip: для распаковки PPTX (ZIP-архивов)

## Использование в коде

```typescript
// Импорт из SCORM
import { importScormPackage } from '@/utils/scorm-import';

// Импорт из PPTX
import { importPptxPackage } from '@/utils/pptx-import';

// ...

// В обработчике загрузки SCORM файла
const handleScormFileUpload = async (file: File) => {
  try {
    // Импорт SCORM и получение слайдов
    const slides = await importScormPackage(file);
    
    // Добавление слайдов в презентацию
    // ...
  } catch (error) {
    // Обработка ошибок
  }
};

// В обработчике загрузки PPTX файла
const handlePptxFileUpload = async (file: File) => {
  try {
    // Импорт PPTX и получение слайдов с изображениями
    const slides = await importPptxPackage(file);
    
    // Добавление слайдов в презентацию
    // ...
  } catch (error) {
    // Обработка ошибок
  }
};
```

## Будущие улучшения

- Сохранение ресурсов на сервере для постоянного доступа
- Улучшенное распознавание и конвертация тестов из различных платформ
- Поддержка интерактивных элементов и сложных сценариев SCORM
- Возможность импорта видео-контента
- Улучшенная обработка PowerPoint:
  - Извлечение текстового содержимого
  - Поддержка форматирования
  - Сохранение структуры слайдов
  - Конвертация списков, таблиц и диаграмм 